<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="manifest" href="manifest.json" />

    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="PWA Service Worker" />
    <meta name="apple-mobile-web-app-title" content="PWA Service Worker" />
    <meta name="theme-color" content="#6366f1" />
    <meta name="msapplication-navbutton-color" content="#6366f1" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="msapplication-starturl" content="/" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <link
      rel="icon"
      type="image/svg"
      sizes="192x192"
      href="/src/assets/images/logo.svg"
    />
    <link
      rel="apple-touch-icon"
      type="image/svg"
      sizes="192x192"
      href="/src/assets/images/logo.svg"
    />

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <title>âœ¨ StarterPack Project âœ¨</title>
    <!-- ðŸ‘‡ css code file ðŸ‘‡ -->
    <link rel="stylesheet" href="./src/style/global.css" />
  </head>
  <body>
    <!-- auto responsive navigation bar -->
    <nav id="navbar" class="navibar">
      <a href="#home" class="active">Home</a>
      <a href="#about">About</a>
      <a href="https://youtube.com/deaafrizal">Youtube</a>
      <a href="javascript:void(0);" class="icon" onclick="showMobileNav()">
        <i class="fa fa-bars"></i>
      </a>
    </nav>

    <!-- ðŸ‘‡ your content here ðŸ‘‡ -->
    <div class="container">
      <div class="glowingTitle">ðŸ¥¶ StarterPack Project ðŸ¥¶</div>
      <img src="./src/assets/images/logo.svg" width="150" height="150" />
      <button class="btn" onclick="showPopup('babypack')">Test Function</button>
    </div>

    <!-- ðŸ‘‡ javascript code file ðŸ‘‡ -->
    <script>
      /**
       * Langkah pertama mendaftarkan service worker di navigator
       */
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/serviceWorker.js")
          .then((registration) => {
            console.log("SW registered", registration.scope);
          })
          .catch((err) => {
            console.log("SW registration failed", err);
          });
      }

      /**
       * Langkah kedua menyiapkan data yang akan di caching
       */
      const cache1 = "Learn-Cache0";
      const cacheAssets = [
        "/",
        "/src/style/global.css",
        "/src/js/index.js",
        "/src/assets/images/logo.svg",
      ];

      /**
       * Langkah ketiga mengunduh / menginstall service worker di browser
       * Pada langkah ini biasanya menyertakan cacheAssets yang akan di caching
       * Ini adalah tempat yang cocok untuk memasukan data ke dalam cache
       */
      self.addEventListener("install", (event) => {
        event.waitUntil(
          caches
            .open(cache1)
            .then((cache) => {
              cache.addAll(cacheAssets);
              console.log("caching successfully");
            })
            .catch((err) => {
              console.log("caching failed");
            })
        );
      });

      /**
       * Langkah keempat untuk menghapus cache yang tidak diperlukan lagi
       * Pada langkah ini biasanya sw akan mengecek apakah ada cache yang baru dibuat,
       * Ketika ada maka sw akan menghapus cache lama
       * Ini adalah tempat yang cocok untuk menghapus cache
       */
      self.addEventListener("activate", function (event) {
        console.log("activate dijalankan");
        event.waitUntil(
          caches.keys().then((cacheNames) => {
            return Promise.all(
              cacheNames
                .filter((cacheName) => {
                  return cacheName !== cache1;
                })
                .map((cacheName) => {
                  caches.delete(cacheName);
                })
            );
          })
        );
      });

      /**
       * Langkah kelima untuk mengambil data dari cache
       * Pada langkah ini biasanya sw akan mengecek apakah request yang masuk sudah ada di cache atau belum,
       * Jika ada maka sw akan menampilkan data dari cache
       * Jika tidak ada maka sw akan mengirim request ke server
       * Ini adalah tempat yang cocok untuk mengambil data dari cache
       */
      self.addEventListener("fetch", (event) => {
        event.respondWith(
          caches.match(event.request).then((response) => {
            if (response) {
              return response;
            }

            return fetch(event.request);
          })
        );
      });
    </script>
  </body>
</html>
